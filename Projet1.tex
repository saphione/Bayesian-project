% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Projet1\_Bayesian},
  pdfauthor={Lorazo, M. De Koninck, A},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Projet1\_Bayesian}
\author{Lorazo, M. De Koninck, A}
\date{2024-12-07}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readr)}
\FunctionTok{library}\NormalTok{(R2jags)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Le chargement a nécessité le package : rjags
\end{verbatim}

\begin{verbatim}
## Le chargement a nécessité le package : coda
\end{verbatim}

\begin{verbatim}
## Linked to JAGS 4.3.1
\end{verbatim}

\begin{verbatim}
## Loaded modules: basemod,bugs
\end{verbatim}

\begin{verbatim}
## 
## Attachement du package : 'R2jags'
\end{verbatim}

\begin{verbatim}
## L'objet suivant est masqué depuis 'package:coda':
## 
##     traceplot
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hoopoe }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}\StringTok{"C:/Users/Saphione/OneDrive/Fac/M2/Cours/Bayésien/Projet/projet1/hoopoe.csv"}\NormalTok{, }\AttributeTok{delim =} \StringTok{";"}\NormalTok{, }\AttributeTok{escape\_double =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{trim\_ws =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 1048 Columns: 7
## -- Column specification --------------------------------------------------------
## Delimiter: ";"
## chr (5): y, ring, height, hab, habitat
## dbl (2): bare, heightC
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hoopoe }\OtherTok{\textless{}{-}}\NormalTok{ hoopoe[,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{,}\DecValTok{5}\SpecialCharTok{:}\DecValTok{7}\NormalTok{)]}
\NormalTok{hoopoe}\SpecialCharTok{$}\NormalTok{ring }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{ring)}
\end{Highlighting}
\end{Shaded}

We analysed the data separately for each species, applying a
hierarchical logistic regression model (with random intercept and slope
parameters) implemented in a Bayesian framework using Markov chain Monte
Carlo simulation (Appendix S1). The response variable was Boolean, with
a 0 value for random locations and 1 for foraging locations. For each
dominant habitat category for hoopoe (fruit tree plantation, grassland,
all remaining habitat types together) we first ran the basic model
including effects of bare ground and its square, as well as vegetation
height and its square. This enabled us to evaluate whether the
relationships between bird occurrence and vegetation structure were
consistent among broad habitat categories. We found that this was the
case (Figure S1), and thus did not consider habitat categories in
subsequent analyses.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# \%bareground}
\NormalTok{x\_bg }\OtherTok{\textless{}{-}}\NormalTok{ hoopoe}\SpecialCharTok{$}\NormalTok{bare}
\NormalTok{hoopoe}\SpecialCharTok{$}\NormalTok{x\_bg\_carr }\OtherTok{\textless{}{-}}\NormalTok{ (x\_bg)}\SpecialCharTok{\^{}}\DecValTok{2}
\CommentTok{\# vegetation height}
\NormalTok{x\_vh }\OtherTok{\textless{}{-}}\NormalTok{ hoopoe}\SpecialCharTok{$}\NormalTok{heightC}
\NormalTok{hoopoe}\SpecialCharTok{$}\NormalTok{x\_vh\_carr }\OtherTok{\textless{}{-}}\NormalTok{ (x\_vh)}\SpecialCharTok{\^{}}\DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{datahoopoe }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{N =} \FunctionTok{length}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{y),}
  \AttributeTok{y =} \FunctionTok{ifelse}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{y }\SpecialCharTok{==} \StringTok{"random"}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{),}
  \AttributeTok{ring =} \FunctionTok{as.numeric}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{ring),}
  \AttributeTok{nb =} \FunctionTok{length}\NormalTok{(}\FunctionTok{levels}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{ring)),}
  \AttributeTok{bare =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{scale}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{bare)),}
  \AttributeTok{bare\_carre =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{scale}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{x\_bg\_carr)),}
  \AttributeTok{height =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{scale}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{heightC)),}
  \AttributeTok{height\_carre =} \FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{scale}\NormalTok{(hoopoe}\SpecialCharTok{$}\NormalTok{x\_vh\_carr))}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{logisitic }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{()\{}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{N)\{}
\NormalTok{    y[i] }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dbin}\NormalTok{(p[i],}\DecValTok{1}\NormalTok{) }\CommentTok{\# binomial likelihood}
    \FunctionTok{logit}\NormalTok{(p[i]) }\OtherTok{\textless{}{-}}\NormalTok{ a[ring[i]] }\SpecialCharTok{+}\NormalTok{ b.bare[ring[i]] }\SpecialCharTok{*}\NormalTok{ bare[i] }\SpecialCharTok{+}\NormalTok{ b.bare\_carre[ring[i]] }\SpecialCharTok{*}\NormalTok{ bare\_carre[i] }\SpecialCharTok{+}\NormalTok{ b.height[ring[i]] }\SpecialCharTok{*}\NormalTok{ height[i] }\SpecialCharTok{+}\NormalTok{ b.height\_carre[ring[i]] }\SpecialCharTok{*}\NormalTok{ height\_carre[i]}
\NormalTok{  \}}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{nb)\{}
\NormalTok{    a[j] }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(mua,tau.a) }
\NormalTok{    b.bare[j] }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(mubare,tau.b)}
\NormalTok{    b.bare\_carre[j] }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(mubarec,tau.bc)}
\NormalTok{    b.height[j] }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(muheight,tau.v)}
\NormalTok{    b.height\_carre[j] }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(muheightc,tau.vc) }
\NormalTok{  \}}
\NormalTok{mua }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.001}\NormalTok{) }
\NormalTok{mubare }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.001}\NormalTok{) }
\NormalTok{mubarec }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.001}\NormalTok{) }
\NormalTok{muheight }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.001}\NormalTok{)}
\NormalTok{muheightc }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dnorm}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.001}\NormalTok{)}
\NormalTok{tau.a }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ (sigma.a }\SpecialCharTok{*}\NormalTok{ sigma.a)}
\NormalTok{sigma.a }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dunif}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\NormalTok{tau.b }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ (sigma.b }\SpecialCharTok{*}\NormalTok{ sigma.b)}
\NormalTok{sigma.b }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dunif}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\NormalTok{tau.bc }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ (sigma.bc }\SpecialCharTok{*}\NormalTok{ sigma.bc)}
\NormalTok{sigma.bc }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dunif}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\NormalTok{tau.v }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ (sigma.v }\SpecialCharTok{*}\NormalTok{ sigma.v)}
\NormalTok{sigma.v }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dunif}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\NormalTok{tau.vc }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{/}\NormalTok{ (sigma.vc }\SpecialCharTok{*}\NormalTok{ sigma.vc)}
\NormalTok{sigma.vc }\SpecialCharTok{\textasciitilde{}} \FunctionTok{dunif}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{100}\NormalTok{)}
\NormalTok{\}}

\CommentTok{\# initial values}
\NormalTok{init1 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \FunctionTok{rep}\NormalTok{(}\FloatTok{0.5}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare\_carre =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height\_carre =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb))}
\NormalTok{init2 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare\_carre =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height\_carre =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb))}
\NormalTok{init3 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare =} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare\_carre =} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height =} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height\_carre =} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb))}
\NormalTok{init4 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare\_carre =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height\_carre =} \FunctionTok{rep}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb))}
\NormalTok{init5 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.bare\_carre =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb), }\AttributeTok{b.height\_carre =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\NormalTok{, datahoopoe}\SpecialCharTok{$}\NormalTok{nb))}
\NormalTok{init }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(init1, init2, init3, init4, init5)}

\CommentTok{\# parameters to monitor , }
\NormalTok{params }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{,}\StringTok{"b.bare"}\NormalTok{, }\StringTok{"b.bare\_carre"}\NormalTok{, }\StringTok{"b.height"}\NormalTok{, }\StringTok{"b.height\_carre"}\NormalTok{)}
\CommentTok{\# call jags to fit model}
\NormalTok{partial\_pooling\_fit }\OtherTok{\textless{}{-}} \FunctionTok{jags}\NormalTok{(}\AttributeTok{data =}\NormalTok{ datahoopoe,}
                             \AttributeTok{inits =}\NormalTok{ init,}
                             \AttributeTok{parameters.to.save =}\NormalTok{ params,}
                             \AttributeTok{model.file =}\NormalTok{ logisitic,}
                             \AttributeTok{n.chains =} \DecValTok{5}\NormalTok{,}
                             \AttributeTok{n.iter =} \DecValTok{60000}\NormalTok{,}
                             \AttributeTok{n.burnin =} \DecValTok{15000}\NormalTok{,}
                             \AttributeTok{n.thin =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## module glm loaded
\end{verbatim}

\begin{verbatim}
## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 1048
##    Unobserved stochastic nodes: 75
##    Total graph size: 8061
## 
## Initializing model
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{partial\_pooling\_fit}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Inference for Bugs model at "C:/Users/Saphione/AppData/Local/Temp/Rtmpy64TgK/model4f3c658a3a21", fit using jags,
##  5 chains, each with 60000 iterations (first 15000 discarded)
##  n.sims = 225000 iterations saved. Running time = 338.45 secs
##                    mu.vect sd.vect    2.5%     25%     50%      75%    97.5%
## a[1]                -0.210   0.220  -0.666  -0.354  -0.199   -0.057    0.195
## a[2]                -0.243   0.367  -1.064  -0.457  -0.204    0.003    0.396
## a[3]                 0.052   0.228  -0.394  -0.097   0.048    0.199    0.513
## a[4]                 0.034   0.359  -0.674  -0.183   0.023    0.243    0.792
## a[5]                -0.431   0.320  -1.115  -0.636  -0.408   -0.197    0.113
## a[6]                -0.027   0.241  -0.505  -0.182  -0.027    0.127    0.457
## a[7]                -0.055   0.257  -0.580  -0.217  -0.050    0.110    0.448
## a[8]                -0.162   0.269  -0.728  -0.332  -0.146    0.019    0.333
## a[9]                -0.396   0.287  -0.999  -0.584  -0.381   -0.189    0.104
## a[10]                0.061   0.213  -0.355  -0.080   0.058    0.200    0.491
## a[11]               -0.081   0.349  -0.820  -0.286  -0.067    0.133    0.595
## a[12]                0.379   0.245  -0.072   0.204   0.372    0.543    0.879
## a[13]                0.292   0.238  -0.136   0.123   0.282    0.450    0.785
## b.bare[1]            3.801   0.429   2.938   3.522   3.803    4.088    4.639
## b.bare[2]            4.002   0.497   3.070   3.677   3.980    4.305    5.049
## b.bare[3]            4.028   0.445   3.210   3.724   4.010    4.307    4.962
## b.bare[4]            4.031   0.494   3.132   3.701   4.004    4.327    5.093
## b.bare[5]            3.940   0.481   2.992   3.636   3.933    4.242    4.917
## b.bare[6]            4.044   0.441   3.231   3.741   4.027    4.324    4.966
## b.bare[7]            4.200   0.554   3.258   3.812   4.146    4.536    5.426
## b.bare[8]            4.272   0.568   3.326   3.869   4.209    4.617    5.538
## b.bare[9]            4.112   0.485   3.247   3.775   4.082    4.411    5.155
## b.bare[10]           3.703   0.446   2.761   3.426   3.717    4.004    4.530
## b.bare[11]           3.842   0.490   2.819   3.543   3.850    4.156    4.790
## b.bare[12]           3.802   0.429   2.939   3.522   3.801    4.089    4.641
## b.bare[13]           3.936   0.415   3.145   3.657   3.928    4.203    4.779
## b.bare_carre[1]     -3.507   0.482  -4.490  -3.820  -3.491   -3.181   -2.595
## b.bare_carre[2]     -2.962   0.526  -3.963  -3.313  -2.979   -2.624   -1.885
## b.bare_carre[3]     -3.161   0.412  -4.001  -3.424  -3.152   -2.884   -2.381
## b.bare_carre[4]     -3.241   0.560  -4.380  -3.596  -3.234   -2.877   -2.144
## b.bare_carre[5]     -2.423   0.748  -3.701  -2.962  -2.484   -1.948   -0.817
## b.bare_carre[6]     -2.907   0.610  -4.076  -3.313  -2.929   -2.513   -1.662
## b.bare_carre[7]     -2.215   0.669  -3.452  -2.684  -2.220   -1.768   -0.874
## b.bare_carre[8]     -2.380   0.650  -3.562  -2.842  -2.396   -1.943   -1.060
## b.bare_carre[9]     -2.799   0.456  -3.691  -3.110  -2.796   -2.489   -1.913
## b.bare_carre[10]    -3.241   0.426  -4.055  -3.524  -3.251   -2.970   -2.368
## b.bare_carre[11]    -3.445   0.607  -4.734  -3.820  -3.412   -3.042   -2.321
## b.bare_carre[12]    -3.574   0.435  -4.443  -3.863  -3.566   -3.281   -2.732
## b.bare_carre[13]    -3.308   0.398  -4.118  -3.566  -3.301   -3.041   -2.549
## b.height[1]         -0.475   0.571  -1.533  -0.858  -0.500   -0.121    0.732
## b.height[2]         -0.737   0.786  -2.321  -1.244  -0.726   -0.219    0.786
## b.height[3]         -0.952   0.547  -2.076  -1.299  -0.939   -0.587    0.091
## b.height[4]         -0.795   0.833  -2.482  -1.331  -0.780   -0.243    0.806
## b.height[5]         -2.878   0.850  -4.668  -3.417  -2.837   -2.294   -1.329
## b.height[6]         -0.033   0.578  -1.145  -0.415  -0.043    0.340    1.139
## b.height[7]          0.158   0.609  -1.010  -0.244   0.151    0.547    1.394
## b.height[8]         -0.029   0.586  -1.179  -0.413  -0.034    0.352    1.141
## b.height[9]          0.536   0.669  -0.876   0.124   0.569    0.981    1.776
## b.height[10]        -0.713   0.549  -1.880  -1.054  -0.687   -0.343    0.295
## b.height[11]        -0.550   0.715  -1.985  -1.011  -0.541   -0.079    0.841
## b.height[12]         0.183   0.607  -0.889  -0.233   0.139    0.548    1.510
## b.height[13]         0.054   0.516  -0.911  -0.292   0.035    0.382    1.126
## b.height_carre[1]   -0.272   0.570  -1.535  -0.608  -0.225    0.108    0.736
## b.height_carre[2]   -0.187   0.652  -1.629  -0.544  -0.143    0.216    1.004
## b.height_carre[3]    0.028   0.549  -1.020  -0.324   0.012    0.361    1.184
## b.height_carre[4]   -0.137   0.665  -1.569  -0.505  -0.109    0.258    1.139
## b.height_carre[5]   -0.097   0.645  -1.422  -0.470  -0.089    0.278    1.204
## b.height_carre[6]   -0.090   0.543  -1.209  -0.426  -0.077    0.256    0.968
## b.height_carre[7]   -0.096   0.599  -1.355  -0.447  -0.076    0.277    1.059
## b.height_carre[8]   -0.026   0.606  -1.251  -0.392  -0.024    0.340    1.203
## b.height_carre[9]    0.249   0.604  -0.817  -0.154   0.197    0.602    1.584
## b.height_carre[10]   0.191   0.579  -0.837  -0.194   0.146    0.527    1.476
## b.height_carre[11]  -0.082   0.629  -1.381  -0.447  -0.069    0.292    1.164
## b.height_carre[12]  -0.345   0.586  -1.666  -0.684  -0.285    0.055    0.651
## b.height_carre[13]  -0.178   0.522  -1.283  -0.501  -0.152    0.169    0.789
## deviance           998.604  10.206 980.299 991.456 998.027 1005.146 1020.209
##                     Rhat  n.eff
## a[1]               1.001  22000
## a[2]               1.001 110000
## a[3]               1.001 200000
## a[4]               1.001 120000
## a[5]               1.001  16000
## a[6]               1.001 220000
## a[7]               1.001  96000
## a[8]               1.001  39000
## a[9]               1.001  32000
## a[10]              1.001 220000
## a[11]              1.001 130000
## a[12]              1.001  30000
## a[13]              1.001  55000
## b.bare[1]          1.001  87000
## b.bare[2]          1.001  40000
## b.bare[3]          1.001  36000
## b.bare[4]          1.001  41000
## b.bare[5]          1.001  21000
## b.bare[6]          1.001  19000
## b.bare[7]          1.001   9400
## b.bare[8]          1.001  14000
## b.bare[9]          1.001  23000
## b.bare[10]         1.001  63000
## b.bare[11]         1.001 140000
## b.bare[12]         1.001 220000
## b.bare[13]         1.001  80000
## b.bare_carre[1]    1.001 220000
## b.bare_carre[2]    1.001  25000
## b.bare_carre[3]    1.001  44000
## b.bare_carre[4]    1.001 210000
## b.bare_carre[5]    1.001  43000
## b.bare_carre[6]    1.001  24000
## b.bare_carre[7]    1.001   9300
## b.bare_carre[8]    1.001  16000
## b.bare_carre[9]    1.001  21000
## b.bare_carre[10]   1.001  99000
## b.bare_carre[11]   1.001 200000
## b.bare_carre[12]   1.001 120000
## b.bare_carre[13]   1.001 170000
## b.height[1]        1.001  33000
## b.height[2]        1.001  29000
## b.height[3]        1.001  32000
## b.height[4]        1.001  46000
## b.height[5]        1.001  32000
## b.height[6]        1.001  27000
## b.height[7]        1.001  15000
## b.height[8]        1.001  29000
## b.height[9]        1.001  19000
## b.height[10]       1.001  26000
## b.height[11]       1.001  40000
## b.height[12]       1.001  20000
## b.height[13]       1.001  25000
## b.height_carre[1]  1.001  25000
## b.height_carre[2]  1.001  51000
## b.height_carre[3]  1.001  20000
## b.height_carre[4]  1.001  23000
## b.height_carre[5]  1.001 150000
## b.height_carre[6]  1.001  23000
## b.height_carre[7]  1.001  18000
## b.height_carre[8]  1.001  16000
## b.height_carre[9]  1.001  21000
## b.height_carre[10] 1.001  20000
## b.height_carre[11] 1.001  41000
## b.height_carre[12] 1.001  19000
## b.height_carre[13] 1.001  27000
## deviance           1.001  28000
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule: pV = var(deviance)/2)
## pV = 52.1 and DIC = 1050.7
## DIC is an estimate of expected predictive error (lower deviance is better).
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\FunctionTok{hist}\NormalTok{(partial\_pooling\_fit}\SpecialCharTok{$}\NormalTok{BUGSoutput}\SpecialCharTok{$}\NormalTok{sims.matrix)}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{density}\NormalTok{(partial\_pooling\_fit}\SpecialCharTok{$}\NormalTok{BUGSoutput}\SpecialCharTok{$}\NormalTok{sims.matrix))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Projet1_files/figure-latex/logisitic model complet-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{traceplot}\NormalTok{(partial\_pooling\_fit)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-1.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-2.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-3.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-4.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-5.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-6.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-7.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-8.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-9.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-10.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-11.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-12.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-13.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-14.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-15.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-16.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-17.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-18.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-19.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-20.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-21.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-22.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-23.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-24.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-25.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-26.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-27.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-28.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-29.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-30.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-31.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-32.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-33.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-34.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-35.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-36.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-37.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-38.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-39.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-40.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-41.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-42.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-43.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-44.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-45.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-46.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-47.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-48.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-49.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-50.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-51.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-52.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-53.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-54.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-55.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-56.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-57.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-58.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-59.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-60.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-61.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-62.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-63.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-64.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-65.pdf}
\includegraphics{Projet1_files/figure-latex/unnamed-chunk-2-66.pdf}

Second, we fitted different models that included different combinations
of effects of bare ground and its square, as well as vegetation height
and its square. The models were then ranked according to the deviance
information criterion (DIC, {[}26{]}). Squared effects were included
because of a likely trade-off between food abundance and accessibility
on the one hand, and vegetation density and height on the other, which
would result in curvilinear relationships peaking at intermediate values
of predictor variables. Based on the best models we calculated
predictive distributions to evaluate goodness-of-fit. We compared
observed values with predicted values using x2-diagnostics and report
Bayesian Pvalues.

\end{document}
